displayCountries();let theme=localStorage.getItem("theme");"dark"===theme?document.body.classList.add("dark"):document.body.classList.add("light");const themeBtn=document.querySelector(".header__changeThemeBtn"),filterSelect=document.querySelector(".field__filterSelect"),searchInput=document.querySelector(".field__searchInput");let btnContent="",inputValue="";searchInput.addEventListener("input",a=>{inputValue=a.target.value,filterCountries(btnContent,inputValue)}),filterSelect.addEventListener("click",()=>{const a=document.querySelector(".field__filterUl"),b=document.querySelectorAll(".field__filterBtn");a.classList.toggle("field__filterUl--hide"),b.forEach(a=>a.addEventListener("click",()=>{btnContent=a.textContent,filterSelect.textContent=btnContent,filterCountries(btnContent,inputValue)})),window.addEventListener("click",b=>{b.target.classList.contains("field__filterUl")||b.target.classList.contains("field__filterSelect")||a.classList.add("field__filterUl--hide")})}),themeBtn.addEventListener("click",()=>{const a=document.querySelector(".header__changeThemeBtnIcon");"dark"===theme?(document.body.classList.remove("dark"),document.body.classList.add("light"),a.name="moon-outline",theme="light"):(document.body.classList.remove("light"),document.body.classList.add("dark"),a.name="moon",theme="dark"),localStorage.setItem("theme",theme)});async function getCountriesData(){const a=await fetch("https://restcountries.com/v3.1/all"),b=await a.json();return await b}function filterCountries(a,b){function c(a,b){let c=!0;for(let d=0;d<=b.length;d++)a.toLocaleLowerCase()===b.toLocaleLowerCase().slice(0,d)&&(c=!1);return c}const d=document.querySelectorAll(".country");d.forEach(e=>{if(""===a&&""===b)return void d.forEach(a=>a.classList.remove("country--hide"));const f=e.childNodes[1].childNodes[2].childNodes[1].textContent,g=e.childNodes[1].childNodes[0].textContent;"America"===a?a="Americas":a,""===a&&""!==b?c(b,g)?e.classList.add("country--hide"):e.classList.remove("country--hide"):""!==a&&""===b?f===a?e.classList.remove("country--hide"):e.classList.add("country--hide"):c(b,g)||f!==a?e.classList.add("country--hide"):e.classList.remove("country--hide")})}async function displayCountries(){function a(b){const i=document.querySelector(".main__homeInputs"),r=document.querySelector(".main__details");d.classList.add("main__homeContent--hide"),i.classList.add("main__homeInputs--hide"),r.classList.remove("main__details--hide");const s=document.querySelector(".main__detailsBackBtn");s.addEventListener("click",()=>{r.classList.add("main__details--hide"),d.classList.remove("main__homeContent--hide"),i.classList.remove("main__homeInputs--hide")});const t=document.querySelector(".details__img");t.src=h[b],t.alt=`Flag of ${e[b]}`,document.querySelector(".details__name").textContent=e[b];const u=[f[b],g[b],j[b],k[b],l[b],o[b],n[b],m[b]],v=document.querySelectorAll(".country__detailsInfoData");v.forEach((a,b)=>a.textContent=u[b]);const w=document.querySelector(".details__borderCountriesBtns"),x=document.querySelector(".details__message");if(x.classList.add("details__message--hide"),w.textContent="",p[b])for(let a=0;a<p[b].length;a++){const d=document.createElement("button");d.classList.add("details__borderCountryBtn");let e;for(let d in c)if(c[d].cca3===p[b][a]){e=c[d].name.common;break}d.textContent=e,d.setAttribute("data-cca3",p[b][a]),w.append(d)}else x.classList.remove("details__message--hide");const y=document.querySelectorAll(".details__borderCountryBtn");y.forEach(b=>b.addEventListener("click",b=>{const c=b.target.dataset.cca3;a(q.indexOf(c))}))}function b(a){const b=document.createElement("div");b.classList.add("country"),b.id=`country${a}`,b.setAttribute("tabindex","0");const c=document.createElement("img");c.classList.add("country__flag"),c.src=h[a],c.alt=`Flag of ${e[a]}`,b.append(c);const f=document.createElement("article");f.classList.add("country__infoContainer");const i=document.createElement("h2");i.classList.add("country__name"),i.textContent=e[a],f.append(i);const k=["Population: ","Region: ","Capital: "],m=[g[a],j[a],l[a]];for(let b=0;3>b;b++){const a=document.createElement("p");a.classList.add("country__info"),a.textContent=k[b];const c=document.createElement("span");c.classList.add("country__infoData"),c.textContent=m[b],a.append(c),f.append(a)}b.append(f),d.append(b)}const c=await getCountriesData(),d=document.querySelector(".main__homeContent"),e=[],f=[],g=[],h=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[],q=[];for(let a=0;a<c.length;a++)q[a]=c[a].cca3;for(let a=0;a<c.length;a++){for(const b in c[a].name.nativeName){f[a]=c[a].name.nativeName[b].common;break}let d="";for(const b in c[a].currencies)d+=`${c[a].currencies[b].name}, `;n[a]=d.slice(0,d.length-2)||"Does not have";let i="";for(const b in c[a].languages)i+=`${c[a].languages[b]}, `;m[a]=i.slice(0,i.length-2)||"Does not have",e[a]=c[a].name.common,g[a]=c[a].population.toString();const q=[];for(let b=0;b<g[a].length;b++)0==b%3&&0!=b&&q.push(`,`),q.push(g[a][g[a].length-b-1]);g[a]=q.reverse().join(""),h[a]=c[a].flags.svg,j[a]=c[a].region,k[a]=c[a].subregion||"Does not have",l[a]=c[a].capital||"Does not have",o[a]=c[a].tld||"Does not have",p[a]=c[a].borders,b(a)}const r=document.querySelectorAll(".country");r.forEach((b,c)=>b.addEventListener("click",()=>{a(c)})),r.forEach((b,c)=>b.addEventListener("keydown",b=>{"Enter"===b.key&&a(c)})),document.querySelector(".main__homeContentSpin").classList.add("main__homeContentSpin--hide")}