const numberBtns=document.querySelectorAll(".calculator__btnNumber"),opratorBtns=document.querySelectorAll(".calculator__btnOperator"),screenNumber=document.querySelector(".calculator__screenNumber"),screenOperator=document.querySelector(".calculator__screenOperator"),deleteBtn=document.querySelector(".calculator__btnDelete"),resultBtn=document.querySelector(".calculator__btnResult"),resetBtn=document.querySelector(".calculator__btnReset"),addDotBtn=document.querySelector(".calculator__btnAddDot"),themeSwitch=document.querySelector(".themeSwitch"),themeBtns=document.querySelectorAll(".themeSwitch__theme"),operators=["+","=",".","-","*","/","Enter","Backspace","c","r"],numbers=["0","1","2","3","4","5","6","7","8","9"];let operator,firstNumber,secondNumber,lastNumber,result,isFirstNumBeenSave=!1,error=!1,theme=localStorage.getItem("themeColor");setTheme(theme),resetBtn.addEventListener("click",calculatorReset),resultBtn.addEventListener("click",showResult),deleteBtn.addEventListener("click",deleteNumber),addDotBtn.addEventListener("click",addDot),themeBtns.forEach(a=>a.addEventListener("click",()=>{changeTheme(a)})),numberBtns.forEach(a=>a.addEventListener("click",()=>{displayNumber(a.textContent)})),opratorBtns.forEach(a=>a.addEventListener("click",()=>{showOperatorIcon(a.textContent)})),window.addEventListener("keydown",a=>{bindKey(a)});function showOperatorIcon(a){isError()||(operator=a,screenOperator.textContent=operator,animationScreen(),result&&(result=void 0),firstNumber=+screenNumber.textContent,isFirstNumBeenSave=!0)}function showResult(){if(isError())return;secondNumber&&"="===screenOperator.textContent||(secondNumber=+screenNumber.textContent);const a=!!operator,b=!isNaN(secondNumber),c=!isNaN(firstNumber);c&&b&&a&&(result=getResult(firstNumber,secondNumber,operator),screenNumber.textContent=result,screenOperator.textContent="=",firstNumber=result,animationScreen(),resizeFont())}function displayNumber(a){const b=getArrayOfScreenNumber(),c=18>=b.length,d=b.includes("."),e="0"===screenNumber.textContent&&"0"===a&&!d,f="0"===screenNumber.textContent&&"0"!==a&&!d;e||(isError()||isFirstNumBeenSave||f||result?(screenNumber.textContent=a,isFirstNumBeenSave=!1,screenOperator.textContent="",result=void 0):c&&(screenNumber.textContent+=a),resizeFont())}function isError(){return"Division by zero!"===screenNumber.textContent||"Overflow!"===screenNumber.textContent}function getResult(c,a,b){let d;"+"===b?d=c+a:"-"===b?d=c-a:"/"===b?d=c/a:"x"===b?d=c*a:void 0;const e=getErrors(a,b,d).isError,f=getErrors(a,b,d).errorMessage;return e&&(d=f),d}function getErrors(a,b,c){let d=null,e=!1;return 0===a&&"/"===b?(d="Division by zero!",e=!0):c===1/0&&(d="Overflow!",e=!0),{isError:e,errorMessage:d}}function resizeFont(){const a=getArrayOfScreenNumber().length;10>a?setScreenFontSize("big"):10<=a&&17>a?setScreenFontSize("small"):17<=a&&setScreenFontSize("smaller")}function addDot(){if(!isError()){const a=getArrayOfScreenNumber();a.includes(".")||(screenNumber.textContent+=".")}}function deleteNumber(){if(!isError()){const a=getArrayOfScreenNumber();a.pop(),screenNumber.textContent=0===a.length?"0":a.join(""),resizeFont()}}function calculatorReset(){operator=void 0,firstNumber=void 0,secondNumber=void 0,isFirstNumBeenSave=!1,result=void 0,error=!1,screenOperator.textContent="",screenNumber.textContent="0",setScreenFontSize("big")}function animationScreen(){screenNumber.style.opacity="0",setTimeout(()=>{screenNumber.style.opacity="1"},75)}function setScreenFontSize(a){screenNumber.classList.remove("calculator__screenNumber--big"),screenNumber.classList.remove("calculator__screenNumber--small"),screenNumber.classList.remove("calculator__screenNumber--smaller"),screenNumber.classList.add(`calculator__screenNumber--${a}`)}function changeTheme(a){theme=a.classList[1].slice(13),localStorage.removeItem("themeColor"),setTheme(theme)}function setTheme(a="theme1"){localStorage.setItem("themeColor",a),themeSwitch.className=`themeSwitch themeSwitch--${a}`,document.body.className=`body--${a}`}function getArrayOfScreenNumber(){return Array.from(screenNumber.textContent)}function bindKey(a){function b(a){a.classList.add("calculator__btn--active"),setTimeout(()=>{a.classList.remove("calculator__btn--active")},100)}function c(a){let b;return document.querySelectorAll(".calculator__btn").forEach(c=>{c.textContent===a&&(b=c)}),b}const d=operators.some(b=>b===a.key),e=numbers.some(b=>b===a.key);if(d)switch(a.key){case"*":showOperatorIcon("x"),b(c("x"));break;case"Enter":showResult(),b(resultBtn);break;case"=":showResult(),b(resultBtn);break;case"Backspace":deleteNumber(),b(deleteBtn);break;case".":addDot(),b(addDotBtn);break;case"c":calculatorReset(),b(resetBtn);break;case"r":calculatorReset(),b(resetBtn);break;default:showOperatorIcon(a.key),b(c(a.key));}else e&&(displayNumber(a.key),b(c(a.key)))}